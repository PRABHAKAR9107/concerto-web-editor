{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst _ = require(\"lodash\");\n\nconst BaseObserver_1 = require(\"../core/BaseObserver\");\n\nclass StateMachine extends BaseObserver_1.BaseObserver {\n  constructor(engine) {\n    super();\n    this.engine = engine;\n    this.stateStack = [];\n  }\n\n  getCurrentState() {\n    return this.currentState;\n  }\n\n  pushState(state) {\n    this.stateStack.push(state);\n    this.setState(state);\n  }\n\n  popState() {\n    this.stateStack.pop();\n    this.setState(_.last(this.stateStack));\n  }\n\n  setState(state) {\n    state.setEngine(this.engine); // if no state object, get the initial state\n\n    if (this.currentState) {\n      this.currentState.deactivated(state);\n    }\n\n    const old = this.currentState;\n    this.currentState = state;\n\n    if (this.currentState) {\n      this.currentState.activated(old);\n      this.fireEvent({\n        newState: state\n      }, 'stateChanged');\n    }\n  }\n\n}\n\nexports.StateMachine = StateMachine;","map":{"version":3,"sources":["../../../src/core-state/StateMachine.ts"],"names":[],"mappings":";;;;;;AACA,MAAA,CAAA,GAAA,OAAA,CAAA,QAAA,CAAA;;AAEA,MAAA,cAAA,GAAA,OAAA,CAAA,sBAAA,CAAA;;AAMA,MAAa,YAAb,SAAkC,cAAA,CAAA,YAAlC,CAAoE;AAKnE,EAAA,WAAA,CAAY,MAAZ,EAAgC;AAC/B;AACA,SAAK,MAAL,GAAc,MAAd;AACA,SAAK,UAAL,GAAkB,EAAlB;AACA;;AAED,EAAA,eAAe,GAAA;AACd,WAAO,KAAK,YAAZ;AACA;;AAED,EAAA,SAAS,CAAC,KAAD,EAAa;AACrB,SAAK,UAAL,CAAgB,IAAhB,CAAqB,KAArB;AACA,SAAK,QAAL,CAAc,KAAd;AACA;;AAED,EAAA,QAAQ,GAAA;AACP,SAAK,UAAL,CAAgB,GAAhB;AACA,SAAK,QAAL,CAAc,CAAC,CAAC,IAAF,CAAO,KAAK,UAAZ,CAAd;AACA;;AAED,EAAA,QAAQ,CAAC,KAAD,EAAa;AACpB,IAAA,KAAK,CAAC,SAAN,CAAgB,KAAK,MAArB,EADoB,CAGpB;;AACA,QAAI,KAAK,YAAT,EAAuB;AACtB,WAAK,YAAL,CAAkB,WAAlB,CAA8B,KAA9B;AACA;;AACD,UAAM,GAAG,GAAG,KAAK,YAAjB;AACA,SAAK,YAAL,GAAoB,KAApB;;AACA,QAAI,KAAK,YAAT,EAAuB;AACtB,WAAK,YAAL,CAAkB,SAAlB,CAA4B,GAA5B;AACA,WAAK,SAAL,CACC;AACC,QAAA,QAAQ,EAAE;AADX,OADD,EAIC,cAJD;AAMA;AACD;;AA3CkE;;AAApE,OAAA,CAAA,YAAA,GAAA,YAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst _ = require(\"lodash\");\nconst BaseObserver_1 = require(\"../core/BaseObserver\");\nclass StateMachine extends BaseObserver_1.BaseObserver {\n    constructor(engine) {\n        super();\n        this.engine = engine;\n        this.stateStack = [];\n    }\n    getCurrentState() {\n        return this.currentState;\n    }\n    pushState(state) {\n        this.stateStack.push(state);\n        this.setState(state);\n    }\n    popState() {\n        this.stateStack.pop();\n        this.setState(_.last(this.stateStack));\n    }\n    setState(state) {\n        state.setEngine(this.engine);\n        // if no state object, get the initial state\n        if (this.currentState) {\n            this.currentState.deactivated(state);\n        }\n        const old = this.currentState;\n        this.currentState = state;\n        if (this.currentState) {\n            this.currentState.activated(old);\n            this.fireEvent({\n                newState: state\n            }, 'stateChanged');\n        }\n    }\n}\nexports.StateMachine = StateMachine;\n//# sourceMappingURL=StateMachine.js.map"]},"metadata":{},"sourceType":"script"}