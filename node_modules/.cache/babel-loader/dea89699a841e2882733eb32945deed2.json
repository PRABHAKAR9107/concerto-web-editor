{"ast":null,"code":"var _jsxFileName = \"/home/kanav/gsoc_/concerto-web-editor/src/components/main_area_component/components/AdvancedLink.js\";\nimport React, { Component } from 'react';\nimport './style.css';\nimport createEngine, { DiagramModel, DefaultNodeModel, DefaultPortModel, DefaultLinkFactory, DefaultLinkPointWidget, DefaultLinkModel, DefaultLinkWidget, DefaultNodeFactory } from '@projectstorm/react-diagrams';\nimport { DiagramEngine, LinkWidget, PointModel } from '@projectstorm/react-diagrams-core';\nimport { CanvasWidget } from '@projectstorm/react-canvas-core';\nexport class AdvancedLinkModel extends DefaultLinkModel {\n  constructor() {\n    super({\n      type: 'advanced',\n      width: 4\n    });\n  }\n\n}\nexport class AdvancedPortModel extends DefaultPortModel {\n  createLinkModel() {\n    return new AdvancedLinkModel();\n  }\n\n}\n\nconst CustomLinkArrowWidget = props => {\n  const {\n    point,\n    previousPoint\n  } = props;\n  const angle = 90 + Math.atan2(point.getPosition().y - previousPoint.getPosition().y, point.getPosition().x - previousPoint.getPosition().x) * 180 / Math.PI; //translate(50, -10),\n\n  return React.createElement(\"g\", {\n    className: \"arrow\",\n    transform: 'translate(' + point.getPosition().x + ', ' + point.getPosition().y + ')',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45\n    },\n    __self: this\n  }, React.createElement(\"g\", {\n    style: {\n      transform: 'rotate(' + angle + 'deg)'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46\n    },\n    __self: this\n  }, React.createElement(\"g\", {\n    transform: 'translate(0, -3)',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47\n    },\n    __self: this\n  }, React.createElement(\"polygon\", {\n    points: \"0,10 8,30 -8,30\",\n    fill: props.color,\n    onMouseLeave: () => {\n      this.setState({\n        selected: false\n      });\n    },\n    onMouseEnter: () => {\n      this.setState({\n        selected: true\n      });\n    },\n    \"data-id\": point.getID(),\n    \"data-linkid\": point.getLink().getID(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48\n    },\n    __self: this\n  }))));\n};\n\nCustomLinkArrowWidget.displayName = \"CustomLinkArrowWidget\";\nexport class AdvancedLinkWidget extends DefaultLinkWidget {\n  generateArrow(point, previousPoint) {\n    return React.createElement(CustomLinkArrowWidget, {\n      key: point.getID(),\n      point: point,\n      previousPoint: previousPoint,\n      colorSelected: this.props.link.getOptions().selectedColor,\n      color: this.props.link.getOptions().color,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68\n      },\n      __self: this\n    });\n  }\n\n  render() {\n    //ensure id is present for all points on the path\n    var points = this.props.link.getPoints();\n    var paths = [];\n    this.refPaths = []; //draw the multiple anchors and complex line instead\n\n    for (let j = 0; j < points.length - 1; j++) {\n      paths.push(this.generateLink(LinkWidget.generateLinePath(points[j], points[j + 1]), {\n        'data-linkid': this.props.link.getID(),\n        'data-point': j,\n        onMouseDown: event => {\n          this.addPointToLink(event, j + 1);\n        }\n      }, j));\n    } //render the circles\n\n\n    for (let i = 1; i < points.length - 1; i++) {\n      paths.push(this.generatePoint(points[i]));\n    }\n\n    if (this.props.link.getTargetPort() !== null) {\n      paths.push(this.generateArrow(points[points.length - 1], points[points.length - 2]));\n    } else {\n      paths.push(this.generatePoint(points[points.length - 1]));\n    }\n\n    return React.createElement(\"g\", {\n      \"data-default-link-test\": this.props.link.getOptions().testName,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, paths);\n  }\n\n}\nAdvancedLinkWidget.displayName = \"AdvancedLinkWidget\";\nexport class AdvancedLinkFactory extends DefaultLinkFactory {\n  constructor() {\n    super('advanced');\n  }\n\n  generateModel() {\n    return new AdvancedLinkModel();\n  }\n\n  generateReactWidget(event) {\n    return React.createElement(AdvancedLinkWidget, {\n      link: event.model,\n      diagramEngine: this.engine,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    });\n  }\n\n}\n/*\nexport default () => {\n\t//1) setup the diagram engine\n\tvar engine = createEngine();\n\tengine.getLinkFactories().registerFactory(new AdvancedLinkFactory());\n\n\t// create some nodes\n\tvar node1 = new DefaultNodeModel('Source', 'rgb(0,192,255)');\n\tlet port1 = node1.addPort(new AdvancedPortModel(false, 'out'));\n\tnode1.setPosition(100, 100);\n\n\tvar node2 = new DefaultNodeModel('Target', 'rgb(192,255,0)');\n\tvar port2 = node2.addPort(new AdvancedPortModel(true, 'in'));\n\tnode2.setPosition(500, 350);\n\n\tvar node3 = new DefaultNodeModel('Source', 'rgb(0,192,255)');\n\tlet port3 = node3.addPort(new AdvancedPortModel(false, 'out'));\n\tnode3.setPosition(100, 500);\n\n\tvar node4 = new DefaultNodeModel('Target', 'rgb(192,255,0)');\n\tvar port4 = node4.addPort(new AdvancedPortModel(true, 'in'));\n\tnode4.setPosition(500, 450);\n\n\tvar model = new DiagramModel();\n\n\tmodel.addAll(port1.link(port2), port3.link(port4));\n\n\t// add everything else\n\tmodel.addAll(node1, node2, node3, node4);\n\n\t// load model into engine\n\tengine.setModel(model);\n\n\t// render the diagram!\n\treturn (\n\t\t<DemoCanvasWidget>\n\t\t\t<CanvasWidget engine={engine} />\n\t\t</DemoCanvasWidget>\n\t);\n};\n*/\n\nAdvancedLinkWidget.__docgenInfo = {\n  \"description\": \"\",\n  \"methods\": [{\n    \"name\": \"generateArrow\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [{\n      \"name\": \"point\",\n      \"type\": {\n        \"name\": \"PointModel\",\n        \"alias\": \"PointModel\"\n      }\n    }, {\n      \"name\": \"previousPoint\",\n      \"type\": {\n        \"name\": \"PointModel\",\n        \"alias\": \"PointModel\"\n      }\n    }],\n    \"returns\": {\n      \"type\": {\n        \"name\": \"JSX.Element\"\n      }\n    }\n  }],\n  \"displayName\": \"AdvancedLinkWidget\"\n};\n\nif (typeof STORYBOOK_REACT_CLASSES !== \"undefined\") {\n  STORYBOOK_REACT_CLASSES[\"src/components/main_area_component/components/AdvancedLink.js\"] = {\n    name: \"AdvancedLinkWidget\",\n    docgenInfo: AdvancedLinkWidget.__docgenInfo,\n    path: \"src/components/main_area_component/components/AdvancedLink.js\"\n  };\n}","map":{"version":3,"sources":["/home/kanav/gsoc_/concerto-web-editor/src/components/main_area_component/components/AdvancedLink.js"],"names":["React","Component","createEngine","DiagramModel","DefaultNodeModel","DefaultPortModel","DefaultLinkFactory","DefaultLinkPointWidget","DefaultLinkModel","DefaultLinkWidget","DefaultNodeFactory","DiagramEngine","LinkWidget","PointModel","CanvasWidget","AdvancedLinkModel","constructor","type","width","AdvancedPortModel","createLinkModel","CustomLinkArrowWidget","props","point","previousPoint","angle","Math","atan2","getPosition","y","x","PI","transform","color","setState","selected","getID","getLink","AdvancedLinkWidget","generateArrow","link","getOptions","selectedColor","render","points","getPoints","paths","refPaths","j","length","push","generateLink","generateLinePath","onMouseDown","event","addPointToLink","i","generatePoint","getTargetPort","testName","AdvancedLinkFactory","generateModel","generateReactWidget","model","engine"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './style.css';\nimport createEngine, {\n    DiagramModel,\n    DefaultNodeModel,\n    DefaultPortModel,\n    DefaultLinkFactory,\n    DefaultLinkPointWidget,\n    DefaultLinkModel,\n    DefaultLinkWidget,\n    DefaultNodeFactory\n} from '@projectstorm/react-diagrams';\nimport { DiagramEngine, LinkWidget, PointModel } from '@projectstorm/react-diagrams-core';\nimport { CanvasWidget } from '@projectstorm/react-canvas-core';\n\nexport class AdvancedLinkModel extends DefaultLinkModel {\n    constructor() {\n        super({\n            type: 'advanced',\n            width: 4\n        });\n    }\n}\n \nexport class AdvancedPortModel extends DefaultPortModel {\n    createLinkModel(): AdvancedLinkModel | null {\n        return new AdvancedLinkModel();\n    }\n}\n \nconst CustomLinkArrowWidget = props => {\n    const { point, previousPoint } = props;\n \n    const angle =\n        90 +\n        (Math.atan2(\n            point.getPosition().y - previousPoint.getPosition().y,\n            point.getPosition().x - previousPoint.getPosition().x\n        ) *\n            180) /\n            Math.PI;\n \n    //translate(50, -10),\n    return (\n        <g className=\"arrow\" transform={'translate(' + point.getPosition().x + ', ' + point.getPosition().y + ')'}>\n            <g style={{ transform: 'rotate(' + angle + 'deg)' }}>\n                <g transform={'translate(0, -3)'}>\n                    <polygon\n                        points=\"0,10 8,30 -8,30\"\n                        fill={props.color}\n                        onMouseLeave={() => {\n                            this.setState({ selected: false });\n                        }}\n                        onMouseEnter={() => {\n                            this.setState({ selected: true });\n                        }}\n                        data-id={point.getID()}\n                        data-linkid={point.getLink().getID()}></polygon>\n                </g>\n            </g>\n        </g>\n    );\n};\n \nexport class AdvancedLinkWidget extends DefaultLinkWidget {\n    generateArrow(point: PointModel, previousPoint: PointModel): JSX.Element {\n        return (\n            <CustomLinkArrowWidget\n                key={point.getID()}\n                point={point}\n                previousPoint={previousPoint}\n                colorSelected={this.props.link.getOptions().selectedColor}\n                color={this.props.link.getOptions().color}\n            />\n        );\n    }\n \n    render() {\n        //ensure id is present for all points on the path\n        var points = this.props.link.getPoints();\n        var paths = [];\n        this.refPaths = [];\n \n        //draw the multiple anchors and complex line instead\n        for (let j = 0; j < points.length - 1; j++) {\n            paths.push(\n                this.generateLink(\n                    LinkWidget.generateLinePath(points[j], points[j + 1]),\n                    {\n                        'data-linkid': this.props.link.getID(),\n                        'data-point': j,\n                        onMouseDown: (event: MouseEvent) => {\n                            this.addPointToLink(event, j + 1);\n                        }\n                    },\n                    j\n                )\n            );\n        }\n \n        //render the circles\n        for (let i = 1; i < points.length - 1; i++) {\n            paths.push(this.generatePoint(points[i]));\n        }\n \n        if (this.props.link.getTargetPort() !== null) {\n            paths.push(this.generateArrow(points[points.length - 1], points[points.length - 2]));\n        } else {\n            paths.push(this.generatePoint(points[points.length - 1]));\n        }\n \n        return <g data-default-link-test={this.props.link.getOptions().testName}>{paths}</g>;\n    }\n}\n \nexport class AdvancedLinkFactory extends DefaultLinkFactory {\n    constructor() {\n        super('advanced');\n    }\n \n    generateModel(): AdvancedLinkModel {\n        return new AdvancedLinkModel();\n    }\n \n    generateReactWidget(event): JSX.Element {\n        return <AdvancedLinkWidget link={event.model} diagramEngine={this.engine} />;\n    }\n}\n/*\nexport default () => {\n\t//1) setup the diagram engine\n\tvar engine = createEngine();\n\tengine.getLinkFactories().registerFactory(new AdvancedLinkFactory());\n\n\t// create some nodes\n\tvar node1 = new DefaultNodeModel('Source', 'rgb(0,192,255)');\n\tlet port1 = node1.addPort(new AdvancedPortModel(false, 'out'));\n\tnode1.setPosition(100, 100);\n\n\tvar node2 = new DefaultNodeModel('Target', 'rgb(192,255,0)');\n\tvar port2 = node2.addPort(new AdvancedPortModel(true, 'in'));\n\tnode2.setPosition(500, 350);\n\n\tvar node3 = new DefaultNodeModel('Source', 'rgb(0,192,255)');\n\tlet port3 = node3.addPort(new AdvancedPortModel(false, 'out'));\n\tnode3.setPosition(100, 500);\n\n\tvar node4 = new DefaultNodeModel('Target', 'rgb(192,255,0)');\n\tvar port4 = node4.addPort(new AdvancedPortModel(true, 'in'));\n\tnode4.setPosition(500, 450);\n\n\tvar model = new DiagramModel();\n\n\tmodel.addAll(port1.link(port2), port3.link(port4));\n\n\t// add everything else\n\tmodel.addAll(node1, node2, node3, node4);\n\n\t// load model into engine\n\tengine.setModel(model);\n\n\t// render the diagram!\n\treturn (\n\t\t<DemoCanvasWidget>\n\t\t\t<CanvasWidget engine={engine} />\n\t\t</DemoCanvasWidget>\n\t);\n};\n*/"]},"metadata":{},"sourceType":"module"}